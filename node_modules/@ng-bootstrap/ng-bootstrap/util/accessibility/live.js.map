{"version":3,"file":"live.js","sourceRoot":"","sources":["../../../src/util/accessibility/live.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,UAAU,EAAE,MAAM,EAAE,cAAc,EAAY,MAAM,eAAe,CAAC;AAC5E,OAAO,EAAC,QAAQ,EAAC,MAAM,iBAAiB,CAAC;AAOzC,MAAM,CAAC,IAAM,eAAe,GAAG,IAAI,cAAc,CAAuB,sBAAsB,CAAC,CAAC;AAChG,MAAM,CAAC,IAAM,uBAAuB,GAAyB,GAAG,CAAC;AAIjE,2BAA2B,QAAQ;IACjC,IAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAE9C,OAAO,CAAC,YAAY,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;IAC5C,OAAO,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IAE5C,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;IAEjC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;IAEnC,MAAM,CAAC,OAAO,CAAC;CAChB;;IAQC,cAA8B,UAAgD;QAAA,WAAM,GAAN,MAAM;QAClF,IAAI,CAAC,QAAQ,GAAG,iBAAiB,CAAC,QAAQ,CAAC,CAAC;KAC7C;IAED,0BAAW,GAAX,cAAgB,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE;IAEzE,kBAAG,GAAH,UAAI,OAAe;QACjB,IAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC9B,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;QAE1B,OAAO,CAAC,WAAW,GAAG,EAAE,CAAC;QACzB,IAAM,OAAO,GAAG,cAAM,OAAA,OAAO,CAAC,WAAW,GAAG,OAAO,EAA7B,CAA6B,CAAC;QACpD,EAAE,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,CAAC;YACnB,OAAO,EAAE,CAAC;SACX;QAAC,IAAI,CAAC,CAAC;YACN,UAAU,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;SAC5B;KACF;;gBArBF,UAAU;;;;gDAII,MAAM,SAAC,QAAQ;gDAAkB,MAAM,SAAC,eAAe;;eAhCtE;;SA6Ba,IAAI","sourcesContent":["import {Injectable, Inject, InjectionToken, OnDestroy} from '@angular/core';\nimport {DOCUMENT} from '@angular/common';\n\n\n\n// usefulness (and default value) of delay documented in Material's CDK\n// https://github.com/angular/material2/blob/6405da9b8e8532a7e5c854c920ee1815c275d734/src/cdk/a11y/live-announcer/live-announcer.ts#L50\nexport type ARIA_LIVE_DELAY_TYPE = number | null;\nexport const ARIA_LIVE_DELAY = new InjectionToken<ARIA_LIVE_DELAY_TYPE>('live announcer delay');\nexport const DEFAULT_ARIA_LIVE_DELAY: ARIA_LIVE_DELAY_TYPE = 100;\n\n\n\nfunction createLiveElement(document): HTMLElement {\n  const element = document.createElement('div');\n\n  element.setAttribute('aria-live', 'polite');\n  element.setAttribute('aria-atomic', 'true');\n\n  element.classList.add('sr-only');\n\n  document.body.appendChild(element);\n\n  return element;\n}\n\n\n\n@Injectable()\nexport class Live implements OnDestroy {\n  private _element: HTMLElement;\n\n  constructor(@Inject(DOCUMENT) document: any, @Inject(ARIA_LIVE_DELAY) private _delay: ARIA_LIVE_DELAY_TYPE) {\n    this._element = createLiveElement(document);\n  }\n\n  ngOnDestroy() { this._element.parentElement.removeChild(this._element); }\n\n  say(message: string): void {\n    const element = this._element;\n    const delay = this._delay;\n\n    element.textContent = '';\n    const setText = () => element.textContent = message;\n    if (delay === null) {\n      setText();\n    } else {\n      setTimeout(setText, delay);\n    }\n  }\n}\n"]}